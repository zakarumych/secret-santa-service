# secret-santa-service
Веб-сервис для распределения ролей Секретного Санты в группах.

Все методы POST, параметры передаются в теле запроса, формат JSON (application/json).

Ключевые параметры и их типы:

`user_id` -> `int`<br>
`group_id` -> `int`<br>
`new_admin_id` -> `int`<br>
`gift_recipient_id` -> `int`<br>

`token` -> `str`<br>
`name` -> `str`<br>
`password` -> `str`<br>
`status` -> `str`<br>
`reason` -> `str`<br>

### `/signup` ###
Метод для регистрации пользователя. Требует `name` и `password`. Возвращает `user_id` и `token`. При ошибке возвращает `reason`.

### `/login` ###
Метод для получения токена. Требует `name` и `password`. Старый токен при наличии обнуляется. Возращает `status`. При ошибке возвращает `reason`.

### `/logoff` ###
Метод для обнуления токена. Требует `user_id` и `token`. Возращает `status`. При ошибке возвращает `reason`.


### `/create_group` ###
Метод для создания группы. Требует `user_id` и `token`. `user_id` сразу становится администратором группы. Возращает `group_id`. При ошибке возвращает `reason`.

### `/join_group` ###
Метод для вступления в группу. Требует `user_id`, `group_id` и `token`. В группу нельзя вступить, если она закрыта. Возращает `status`. При ошибке возвращает `reason`.

### `/leave_group` ###
Метод для выхода из группы. Требует `user_id`, `group_id` и `token`. Администратор не может покинуть группу. Группу нельзя покинуть, если она закрыта. Возращает `status`. При ошибке возвращает `reason`.

### `/delete_group` ###
Метод для удаления группы. Требует `user_id`, `group_id` и `token`. Только администратор может удалить группу. Возращает `status`. При ошибке возвращает `reason`.

### `/set_admin` ###
Метод для назначения админа в группе. Требует `user_id`, `group_id`, `new_admin_id` и `token`. Только администратор может назначить нового администратора. Возращает `status`. При ошибке возвращает `reason`.

### `/stop_admin` ###
Метод для удаления прав администратора. Требует `user_id`, `group_id` и `token`. Администратор не может сложить полномочия, если он единственный администратор в группе. Возращает `status`. При ошибке возвращает `reason`.

### `/christmas` ###
Жеребьевка в группе. Требует `user_id`, `group_id` и `token`. Только администратор может начать жеребьевку. Для жеребьевки нужно как минимум два пользователя в группе. После жеребьевки группа закрывается. Возращает `status`. При ошибке возвращает `reason`.


### `/get_gift_recipient_id` ###
Получение индентификатора получателя подарка пользователя в группе. Требует `user_id`, `group_id` и `token`. Требуется, чтобы была проведена жеребьевка. Возращает `gift_recipient_id`. При ошибке возвращает `reason`.

### `/get_user_name_by_id` ###
Получение имени пользователя по его индентификатору. Требует `user_id`. Возвращает `name`. При ошибке возвращает `reason`.


---
Есть рабочая версия по адресу http://secret-santa-api.ru:8080/

###### Пояснения к проекту.
<sub>В папке server расположен сервер. Схемы для базы данных лежат в папке src/sql. База данных SQLite3. Параметры передаются серверу через `.env` файл.</sub>
